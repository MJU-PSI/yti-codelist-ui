<div *ngIf="loading">
  Loading...
  <!--TODO ajax indicator-->
</div>

<div class="row" *ngIf="!loading">
  <div class="col-12">
    <div class="content-box">

      <app-back-button (click)="back()"></app-back-button>

      <div class="row mt-2 mb-2">
        <h1>{{code.codeValue}} - {{code.prefLabels.fi}}</h1>
      </div>

      <div class="row">
        <div class="col-md-9 px-0">
          <app-status [status]="code.status"></app-status>
        </div>
        <div class="col-md-3">
          <div ngbDropdown class="d-inline-block">
            <button class="btn btn-language" id="modifyLanguageDropdown" ngbDropdownToggle>{{modifyLanguage.toUpperCase()}}</button>
            <div ngbDropdownMenu class="dropdown-menu dropdown-menu-right" aria-labelledby="modifyLanguageDropdown">
              <div *ngFor="let language of languages">
                <button class='dropdown-item' [ngClass]="{'bold': language.code === modifyLanguage}" type="button" (click)='setModifyLanguage(language.code)'>{{language.name}}</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <button class="tabNavi" translate>INFORMATION</button>
      </div>

      <div class="row">
        <div class="col-md-9">
          <label translate>Code scheme</label>
          <span>{{code.codeScheme.prefLabels[modifyLanguage]}}</span>

          <label translate>Code value</label>
          <span>{{code.codeValue}}</span>

          <div class="form-group">
            <label for="prefLabel" translate>Code name</label>
            <input id="prefLabel" class="form-control col-5" *ngIf='modifyEnabled' [(ngModel)]="code.prefLabels[modifyLanguage]">
            <span *ngIf='!modifyEnabled'>{{code.prefLabels[modifyLanguage]}}</span>
          </div>

          <div class="form-group">
            <label for="description" translate>Description</label>
            <textarea id="description" rows="3" class="form-control col-10" *ngIf='modifyEnabled' [(ngModel)]="code.descriptions[modifyLanguage]"></textarea>
            <span *ngIf='!modifyEnabled'>{{code.descriptions[modifyLanguage]}}</span>
          </div>

          <div class="form-group">
            <label for="shortName" translate>Short name</label>
            <input id="shortName" *ngIf='modifyEnabled' class="form-control col-5" [(ngModel)]="code.shortName">
            <span *ngIf='!modifyEnabled'>{{code.shortName}}</span>
          </div>

          <label translate>Validity</label>
          <span>{{code.startDate | date:'d.M.y'}} - {{code.endDate | date:'d.M.y'}}</span>

          <label translate>Last modification</label>
          <span>{{code.modified | date:'d.M.y klo hh:mm'}}</span>
        </div>

        <div class="col-md-3 alignRight">
          <div class="row" *ngIf='!modifyEnabled'>
            <button type="button" class="btn btn-action" (click)="modify()" translate>Modify</button>
          </div>
          <div class="row" *ngIf='modifyEnabled'>
            <button type="button" [disabled]='storing' class="btn btn-action" (click)="save()" translate>Save</button>
          </div>
          <div class="row" *ngIf='modifyEnabled'>
            <button type="button" class="btn btn-link" (click)="cancel()" translate>Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
