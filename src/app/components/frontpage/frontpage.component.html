<div *ngIf="loading">
  <app-ajax-loading-indicator></app-ajax-loading-indicator>
</div>

<div *ngIf="!loading">
  <h1>Koodistot</h1>

  <div class="row mb-12">
    <div class="col-md-10">
      <p>Frontpage long description</p>
    </div>
    <div *ngIf="canCreateCodeScheme()" class="col-md-2 float-right d-inline-block">
      <button id="import_codelist_button"
              type="button"
              class="btn btn-action"
              (click)="importCodeScheme()"
              translate>Add code list</button>
    </div>
  </div>

  <div class="row mb-12">
    <div class="input-group input-group-lg input-group-search col-md-4">
      <input class="form-control"
             #schemeSearch
             id="search_box_input"
             type="text"
             [(ngModel)]="searchTerm"
             placeholder="{{'Search for code lists' | translate}}"/>
    </div>
    <div class="col-md-4 mt-2">
      <div class="checkbox">
        <input id="search_code_details_checkbox" type="checkbox" (click)="toggleSearchCodes()">
        <label for="search_code_details_checkbox" translate>Extend search to codes</label>
      </div>
    </div>
  </div>
  <br/>
  <div class="row">
    <div class="col-md-4">
      <div class="inline-label"><span class="search-label">Rajaa tietoalueella</span></div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-4">
      <div class="content-box">
        <h4 class="strong" translate>Classification</h4>
        <div *ngFor="let dataClassification of dataClassifications">
          <div *ngIf="dataClassification.count > 0" class="classification"
              id="{{dataClassification.entity.codeValue + '_classification_filter_link'}}"
               [class.active]="isClassificationSelected(dataClassification.entity)"
               (click)="toggleClassification(dataClassification.entity)">
            <span class="name">{{dataClassification.entity.prefLabel | translateValue:true }}</span>
            <span class="count">({{dataClassification.count}})</span>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-8">

      <div *ngIf="searchInProgress" class="content-box">
        <app-ajax-loading-indicator></app-ajax-loading-indicator>
      </div>

      <div class="codescheme-container content-box" *ngIf="!searchInProgress">

        <div class="inline-label float-left"><span class="search-label" translate>Filter results</span></div>

        <app-filter-dropdown class="d-inline-block"
                             id="organization_filter_dropdown"
                             [filterSubject]="organization$"
                             [options]="organizationOptions"></app-filter-dropdown>

        <app-filter-dropdown class="d-inline-block"
                             id="registry_filter_dropdown"
                             [filterSubject]="registry$"
                             [options]="registryOptions"></app-filter-dropdown>

        <app-filter-dropdown class="d-inline-block"
                             id="status_filter_dropdown"
                             [filterSubject]="status$"
                             [options]="statusOptions"></app-filter-dropdown>

        <div class="row mb-4">
          <div class="col-12">
            <span *ngIf="filteredCodeSchemes.length == 0" translate>Search did not find any code lists.</span>
            <span *ngIf="filteredCodeSchemes.length == 1"><b>1</b> {{'search result' | translate}}</span>
            <span *ngIf="filteredCodeSchemes.length > 1"><b>{{filteredCodeSchemes.length}}</b> {{'search results' | translate}}</span>
          </div>
        </div>

        <div class="row">
          <div class="col-12">
            <div class="result-list-item" *ngFor="let codeScheme of filteredCodeSchemes">
              <div class="codeschemeInListing" id="{{codeScheme.idIdentifier + '_codelist_link'}}" (click)="viewCodeScheme(codeScheme)">
                <div class="name">{{codeScheme.getDisplayName(languageService, true)}}</div>
                <app-status class="float-right" [status]="codeScheme.status"></app-status>
                <div class="description">{{codeScheme.getDisplayDescription(languageService, true)}}</div>
                <div class="classification">{{codeScheme.getDisplayClassificationListing(languageService, true)}}</div>
                <div class="organization">
                  <span *ngIf="codeScheme.codeRegistry.organizations.length == 0" translate>No organization</span>
                  <span *ngIf="codeScheme.codeRegistry.organizations.length == 1">{{codeScheme.codeRegistry.organizations[0].prefLabel | translateValue:true}}</span>
                  <span *ngIf="codeScheme.codeRegistry.organizations.length > 1">{{codeScheme.codeRegistry.organizations.length}} {{'organizations' | translate}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
